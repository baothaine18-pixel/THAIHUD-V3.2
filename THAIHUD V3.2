local name = "th√°i"
-- friendly, corrected greeting label
print("THAIDUI: " .. name .. " (Version 2.0)")

local HeartIcon = "rbxassetid://3926305904"

-- =======================================
-- Small Helpers for Remote Code Handling
-- =======================================

local function fetchRemoteCode(url)
    local ok, res = pcall(function() return game:HttpGet(url) end)
    if not ok or not res or res == "" then
        warn("[THAIDUI] üî¥ Failed to download: " .. tostring(url))
        return nil, res
    end
    return res
end

local function compileCode(code)
    local fn, err = loadstring(code)
    if not fn then
        warn("[THAIDUI] ‚ö†Ô∏è loadstring failed (Invalid Luau): " .. tostring(err))
        return nil, err
    end
    return fn
end

local function safeExecuteUrl(url)
    local code = fetchRemoteCode(url)
    if not code then 
        warn("[THAIDUI] execution stopped: Failed to fetch code.")
        return false 
    end
    local fn = compileCode(code)
    if not fn then 
        warn("[THAIDUI] execution stopped: Failed to compile code.")
        return false 
    end
    local ok, res = pcall(fn)
    if not ok then
        -- ƒê√¢y l√† l·ªói runtime (attempt to call a nil value) b·∫°n th·∫•y tr√™n console
        warn("[THAIDUI] ‚ùå RUNTIME ERROR: " .. tostring(res))
        return false
    end
    return true
end

-- =======================================
-- Confirmation modal helper
-- (Removed the redundant overlay and centralized box creation)
-- =======================================
local function askConfirmation(title, message, onConfirm)
    local existing = game.CoreGui:FindFirstChild("THAIDUI_Confirm")
    if existing then existing:Destroy() end

    local gui = Instance.new("ScreenGui")
    gui.Name = "THAIDUI_Confirm"
    gui.ResetOnSpawn = false
    gui.Parent = game.CoreGui

    local box = Instance.new("Frame")
    box.Name = "ConfirmBox"
    box.Size = UDim2.new(0, 360, 0, 160)
    box.Position = UDim2.new(0.5, -180, 0.5, -80)
    box.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    box.BorderSizePixel = 1
    box.BorderColor3 = Color3.fromRGB(80, 80, 85)
    box.Parent = gui -- ƒê√£ s·ª≠a: box l√† con tr·ª±c ti·∫øp c·ªßa gui, lo·∫°i b·ªè overlay

    local titleLbl = Instance.new("TextLabel")
    titleLbl.Size = UDim2.new(1, -20, 0, 28)
    titleLbl.Position = UDim2.new(0, 10, 0, 6)
    titleLbl.Text = title or "Confirm"
    titleLbl.TextColor3 = Color3.new(1,1,1)
    titleLbl.BackgroundTransparency = 1
    titleLbl.Font = Enum.Font.GothamBold
    titleLbl.TextSize = 18
    titleLbl.TextXAlignment = Enum.TextXAlignment.Left
    titleLbl.Parent = box

    local messageLbl = Instance.new("TextLabel")
    messageLbl.Size = UDim2.new(1, -20, 0, 70)
    messageLbl.Position = UDim2.new(0, 10, 0, 36)
    messageLbl.Text = message or "Are you sure?"
    messageLbl.TextColor3 = Color3.new(0.8,0.8,0.8)
    messageLbl.BackgroundTransparency = 1
    messageLbl.Font = Enum.Font.Code
    messageLbl.TextSize = 14
    messageLbl.TextWrapped = true
    messageLbl.TextXAlignment = Enum.TextXAlignment.Left
    messageLbl.Parent = box

    local yesBtn = Instance.new("TextButton")
    yesBtn.Size = UDim2.new(0.44, 0, 0, 34)
    yesBtn.Position = UDim2.new(0.06, 0, 1, -46)
    yesBtn.Text = "Run"
    yesBtn.BackgroundColor3 = Color3.fromRGB(80, 160, 80)
    yesBtn.TextColor3 = Color3.new(1,1,1)
    yesBtn.Parent = box

    local noBtn = Instance.new("TextButton")
    noBtn.Size = UDim2.new(0.44, 0, 0, 34)
    noBtn.Position = UDim2.new(0.5, 0, 1, -46)
    noBtn.Text = "Cancel"
    noBtn.BackgroundColor3 = Color3.fromRGB(160, 80, 80)
    noBtn.TextColor3 = Color3.new(1,1,1)
    noBtn.Parent = box

    local cleanup = function()
        if gui and gui.Parent then gui:Destroy() end
    end

    yesBtn.MouseButton1Click:Connect(function()
        pcall(function() if onConfirm then onConfirm() end end)
        cleanup()
    end)

    noBtn.MouseButton1Click:Connect(function()
        cleanup()
    end)

    return gui
end

-- =======================================
-- KAVO UI Library Loader (Critical Part)
-- =======================================

local _lib_url = "https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"
local Library = nil
do
    local code = fetchRemoteCode(_lib_url)
    if code then
        local fn = compileCode(code)
        if fn then
            local ok, res = pcall(fn)
            if ok then
                Library = res
            else
                warn("[THAIDUI] ‚ùå UI library runtime error: " .. tostring(res))
            end
        end
    end
end

if not Library then
    -- ƒê√£ s·ª≠a: C·∫£nh b√°o r√µ r√†ng v√† d·ª´ng l·∫°i.
    warn("THAIDUI: üî¥ FAILED TO LOAD UI LIBRARY. Please check the URL: " .. _lib_url)
    return -- D√πng return thay v√¨ error() ƒë·ªÉ script d·ª´ng nh·∫π nh√†ng h∆°n
end

local Window = Library.CreateLib("‚ù§Ô∏è THAIDUI HUB V2 ‚ù§Ô∏è", "DarkTheme")

-- Script Data (Gi·ªØ nguy√™n)
local scripts = {
    ["Blox Fruits"] = {
        ["Gravity Hub"] = "https://raw.githubusercontent.com/Dev-GravityHub/BloxFruit/refs/heads/main/Main.lua",
        ["W-Azure"] = "https://api.luarmor.net/files/v3/loaders/85e904ae1ff30824c1aa007fc7324f8f.lua",
        ["BlueX Hub"] = "https://raw.githubusercontent.com/Dev-BlueX/BlueX-Hub/refs/heads/main/Main.lua",
        ["Master Hub"] = "https://raw.githubusercontent.com/KiddoHiru/BloxFruits/main/MasterHub.lua",
        ["Astral Hub"] = "https://raw.githubusercontent.com/Overgustx2/Main/refs/heads/main/BloxFruits_25.html",
        ["Teddy Hub"] = "https://raw.githubusercontent.com/Teddyseetink/Haidepzai/refs/heads/main/TeddyHub.lua",
        ["Kaitun Script"] = "https://raw.githubusercontent.com/shinichi-dz/phucshinsayhi/refs/heads/main/KaitunBloxFruit.lua",
        ["Server VIP"] = "https://raw.githubusercontent.com/anuragaming1/Meow_gaming/refs/heads/main/Servervip.lua.txt",
        ["Ng·ªçc B·ªïng"] = "https://raw.githubusercontent.com/ngocbonggaming/script/refs/heads/main/NgocBongVn.lua",
        ["Quantum Hub"] = "https://raw.githubusercontent.com/flazhy/QuantumOnyx/refs/heads/main/QuantumOnyx.lua",
        ["TyBoy"] = "https://raw.githubusercontent.com/TBoyRoblox727/TBoyRobloxYTB/refs/heads/main/AllScriptBF.txt",
        ["H√≥d Server"] = "https://github.com/WhiteX1208/Scripts/blob/main/HopScript.luau?raw=true"
    },
    ["Plants vs Brainrots"] = {
        ["Speed Hub"] = "https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua"
    },
    ["C∆∞·ªõp 1 Brainrots"] = {
        ["Luin L·ªõn"] = "http://luminon.top/loader.lua",
        ["Luin Nh·ªè"] = "http://luminon.top/mini.lua",
        ["Vietnam Hub"] = "https://raw.githubusercontent.com/replit8173/VietnamHub/refs/heads/main/VietnamseHub.lua"
    }
}

--=============== T·∫†O TAB SCRIPT ===============--

for Name, List in pairs(scripts) do
    local Tab = Window:NewTab(Name)
    local Section = Tab:NewSection("Danh s√°ch script")

    for BtnName, Link in pairs(List) do
        Section:NewButton(BtnName, "Run script", function()
            askConfirmation("Run Script", "Run \""..tostring(BtnName).."\"? This will download and execute remote code.", function()
                local ok = safeExecuteUrl(Link)
                if ok then
                    warn("[THAIDUI] ‚úÖ Successfully executed: " .. tostring(BtnName))
                end
            end)
        end)
    end
end

--========================================================--
--==============  TAB TH√îNG S·ªê NG∆Ø·ªúI CH∆†I  ===============--
--========================================================--

local PlayerTab = Window:NewTab("Th√¥ng S·ªë Ng∆∞·ªùi Ch∆°i")
local Section = PlayerTab:NewSection("Stats")

local statsOn = false

-- Cleanup existing stat GUI
local existingStatsGui = game.CoreGui:FindFirstChild("THAIDUI_Stats")
if existingStatsGui then
    existingStatsGui:Destroy()
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "THAIDUI_Stats"
ScreenGui.Parent = game.CoreGui
local StatsFrame = Instance.new("Frame")
StatsFrame.Name = "THAIDUI_Frame"
StatsFrame.Parent = ScreenGui
local Text = Instance.new("TextLabel")
Text.Name = "THAIDUI_Text"
Text.Parent = StatsFrame

-- C·∫•u h√¨nh Frame
StatsFrame.Size = UDim2.new(0, 240, 0, 140)
StatsFrame.Position = UDim2.new(0.70, 0, 0.05, 0)
StatsFrame.BackgroundTransparency = 0.2
StatsFrame.BorderSizePixel = 0
StatsFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
StatsFrame.Visible = false
StatsFrame.Active = true
StatsFrame.Draggable = true

-- C·∫•u h√¨nh Text
Text.Size = UDim2.new(1, 0, 1, 0)
Text.BackgroundTransparency = 1
Text.TextColor3 = Color3.fromRGB(255, 255, 255)
Text.Font = Enum.Font.Code
Text.TextXAlignment = Enum.TextXAlignment.Left
Text.TextYAlignment = Enum.TextYAlignment.Top
Text.TextWrapped = true
Text.TextSize = 12

Section:NewToggle("B·∫≠t Stats", "Toggle Player Stats Overlay", function(state)
    statsOn = state
    StatsFrame.Visible = state
end)

-- FPS Counter (ƒê√£ s·ª≠a ƒë·ªïi ƒë·ªÉ t√≠nh to√°n FPS ch√≠nh x√°c)
local fpsCounter = 0
local lastTime = tick()
local fps = 0

game:GetService("RunService").RenderStepped:Connect(function()
    fpsCounter = fpsCounter + 1
    local now = tick()
    if now - lastTime >= 1 then
        fps = math.floor(fpsCounter / (now - lastTime))
        fpsCounter = 0
        lastTime = now
    end
end)

-- Update Stats
task.spawn(function()
    local Players = game:GetService("Players")
    while task.wait(0.1) do
        if statsOn then
            local plr = Players.LocalPlayer
            local char = plr and plr.Character
            local hrp = char and char:FindFirstChild("HumanoidRootPart")
            local hum = char and char:FindFirstChild("Humanoid")
            
            -- ƒê·∫£m b·∫£o kh√¥ng truy c·∫≠p game:GetService("Stats") n·∫øu kh√¥ng c√≥ (Exploit dependent)
            local ping = 0
            if game:GetService("Stats") and game:GetService("Stats").Network.ServerStatsItem["Data Ping"] then
                ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue() or 0
            end

            local posText = "N/A"
            if hrp then
                -- ƒê√£ s·ª≠a: Chuy·ªÉn ƒë·ªïi Vector3 sang chu·ªói an to√†n h∆°n
                posText = string.format("(%.2f, %.2f, %.2f)", hrp.Position.X, hrp.Position.Y, hrp.Position.Z)
            end

            Text.Text =
                "‚ù§Ô∏è THAIDUI Stats ‚ù§Ô∏è\n" ..
                "WalkSpeed: " .. (hum and hum.WalkSpeed or 0) .. "\n" ..
                "JumpPower: " .. (hum and hum.JumpPower or 0) .. "\n" ..
                "Health: " .. (hum and math.floor(hum.Health) or 0) .. "\n" ..
                "FPS: " .. fps .. "\n" ..
                "Ping: " .. ping .. "ms\n" ..
                "Pos: " .. posText
        end
    end
end)
